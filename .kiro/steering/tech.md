# Technology Stack

## Build System

This project uses **Projen** with `@nikovirtala/projen-constructs` to manage project configuration and build tasks. All configuration is defined in `.projenrc.ts`. Do not manually edit generated files (marked with "Generated by projen" comments).

### Projen Configuration
- Uses `AwsCdkTypeScriptAppProject` from `@nikovirtala/projen-constructs` (v0.2.32)
- Integrated Homebrew component for unified tooling installation
- Integrated Mise component for Node.js version management

## Development Workflow

### Conventional Commits

This repository uses **conventional commits** style for both commit messages and pull request titles. Available types:

- `feat`: New features or enhancements
- `fix`: Bug fixes
- `chore`: Maintenance tasks, dependency updates, tooling changes

**Examples:**
- `feat: add new Lambda function for data processing`
- `fix: resolve ES module compatibility issue in main.ts`
- `chore: update projen to v0.98.28`

Both individual commits and pull request titles must follow this format for consistent changelog generation and semantic versioning.

## Languages & Frameworks

- **TypeScript**: CDK infrastructure code (Node.js 24.11.1)
- **Rust**: Lambda function code (stable toolchain, edition 2021)

## Key Dependencies

### Infrastructure (TypeScript)
- `aws-cdk-lib` (v2.165.0): AWS CDK framework
- `cargo-lambda-cdk`: Construct library for Rust Lambda functions
- `constructs`: CDK constructs base library
- `@nikovirtala/projen-constructs` (v0.2.32): Enhanced Projen project types

### Lambda Function (Rust)
- `lambda_runtime`: AWS Lambda runtime for Rust
- `aws-config`, `aws-sdk-s3`: AWS SDK for Rust
- `tokio`: Async runtime
- `serde`, `serde_json`: Serialization
- `tracing`, `tracing-subscriber`: Logging

## Build Tools

### Automated Tool Installation

All build tools are automatically installed via **Homebrew** when running `npm run build`:

- **rustup**: Rust toolchain manager
- **zig**: Cross-compilation toolchain
- **cargo-lambda**: Build tool for Rust Lambda functions
- **mise**: Runtime version manager (for Node.js)

The `Brewfile` at the project root defines all required packages. Tools are installed automatically in both local and CI environments.

**Manual installation (optional):**
```bash
brew bundle  # Installs all tools from Brewfile
```

### How It Works

1. Running `npm run build` triggers the `default` task
2. The `default` task spawns `install:homebrew`
3. Homebrew is installed if not present (CI and local)
4. `brew bundle` installs all packages from `Brewfile`
5. Build proceeds with all tools available

This ensures consistent tooling across local development and CI environments.

## Common Commands

All commands use Projen task runner:

```bash
# Build the project (installs tools automatically)
npm run build

# Synthesize CloudFormation template
npm run synth

# Deploy to AWS
npm run deploy

# Destroy stack
npm run destroy

# Show diff against deployed stack
npm run diff

# Run linter
npm run biome

# Watch mode for development
npm run watch

# Upgrade dependencies
npm run upgrade

# Install Homebrew packages manually
npm run homebrew:bundle
```

## Code Style

- **Biome** for linting and formatting (replaces ESLint + Prettier)
- TypeScript: 120 char line width, semicolons, double quotes
- Rust follows standard `rustfmt` conventions
